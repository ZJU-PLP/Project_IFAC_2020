# Project ICAR 2019

Repository dedicated to the implementation of Adaptive Artificial Potential Fields by Zhang (2017) for the UR5 robotic manipulator in ROS. A new method for controlling UR5 orientation using Artificial Potential Field is proposed.
The full project description will be available shortly after acceptance of the publication in ICAR (2019)

# Author Information

Authors: Caio Cristiano Barros Viturino, Ubiratan de Melo Pinto Junior, André Gustavo Scolari Conceição e Leizer Schnitman

C. C. B. Viturino, U. M. P. Junior and A. G. S. Conceiçãoo are with the LaR - Robotics Laboratory, Department of Electrical and Computer Engineering, Federal University of Bahia, Salvador, Brazil.  
E-mails: engcaiobarros@gmail.com, eng.ele.ubiratan@gmail.com, andre.gustavo@ufba.br.

L. Schnitman is with Department of Chemical Engineering, Federal University of Bahia, Salvador, Brazil.
E-mail: leizer@ufba.br.

## Usage

### To use UR5 with RVIZ + gazebo

To bring up the simulated robot in Gazebo, run:

`roslaunch ur_gazebo ur5.launch`

For setting up the MoveIt! nodes to allow motion planning run:

`roslaunch ur5_moveit_config ur5_moveit_planning_execution.launch sim:=true`

In order to start RViz with a configuration including the MoveIt! Motion Planning plugin run:

`roslaunch ur5_moveit_config moveit_rviz.launch config:=true`

Run the node corresponding to the file UR5_CPA_Gazebo.py

`rosrun custom_codes UR5_CPA_Gazebo.py`

## Results

The final trajectory generated by Adaptive Artificial Potential Fields (AAPF)

![UR5 Final Trajectory](https://github.com/caiobarrosv/Projeto_ICAR_2019/blob/master/imgs/ur5_gripper.jpg)

## Comments

If TF lookupTransform is used, it is necessary to create a new frame corresponding to the end effector.
To do this, add the following lines to the ur5.urdf.xacro file:

```html
<xacro:property name="tool0_offset" value="0.15" />

<link name="${prefix}grasping_link"/>
<joint name="${prefix}ur5_joint_grasping_frame" type="fixed">
  <origin xyz="0 0 ${tool0_offset}" rpy="0 0 0"/>
  <parent link="${prefix}tool0"/>
  <child link="${prefix}grasping_link"/>
</joint>
```

## How to connect to the real UR5 robot

Firstly check the machine IP. The IP configured on the robot must have the last digit different.

`ifconfig`

Disable firewall

`sudo ufw disable`

Set up a static IP on UR5 according to the following figure

![IP Config UR5](https://github.com/caiobarrosv/Projeto_ICAR_2019/blob/master/imgs/config.jpg)

Set up a connection on Ubuntu according to the following figure

![IP Config Ubuntu](https://github.com/caiobarrosv/Projeto_ICAR_2019/blob/master/imgs/config_ethernet2.jpg)

Start ROS with RViz + Gazebo

Bring up - The configured ip must be the same as the robot

`roslaunch ur_modern_driver ur5_bringup.launch robot_ip:=169.254.113.30`
